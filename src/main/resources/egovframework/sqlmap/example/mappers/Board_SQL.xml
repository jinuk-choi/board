<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="egovframework.example.board.service.impl.BoardMapper">

	
<!-- 게시글 리스트 -->	
	<select id="selectBoardList" parameterType="boardVo" resultType="egovMap">
	
			SELECT	@ROWNUM := @ROWNUM - 1 AS ROWNUM,
					ta.*
			FROM 	TB_BOARD ta,
					(SELECT @rownum := (SELECT	COUNT(*)-#{firstIndex}+1 FROM tb_board ta)) tc		
			
			LIMIT	#{firstIndex}, #{recordCountPerPage}
		
	</select>
	<!-- <if test="searchKeyword != null and searchKeyword != ''">
		        <choose>
		            <when test="searchCondition == 0">
						AND	ID LIKE '%' || #{searchKeyword} || '%'
					</when>
		            <when test="searchCondition == 1">
						AND	NAME LIKE '%' || #{searchKeyword} || '%'
					</when>
				</choose>
			</if> -->
	
<!-- 게시글 작성하기 -->			
	<insert id="insertBoard" parameterType="boardVO">

			INSERT INTO TB_BOARD
				(   WRITER
				  , TITLE
				  , CONTENTS )
			VALUES (#{writer}
				  , #{title}
				  , #{contents} )

	</insert>
	
	
<!-- 게시글 수정하기 -->
	<update id="updateBoard">

			UPDATE		TB_BOARD
			SET 		IDX=#{idx}
					   ,WRITER=#{writer}
				       ,CONTENTS=#{contents}
				       ,TITLE=#{title}
			WHERE 	    IDX=#{idx}

	</update>
	
<!-- 게시글 삭제하기 -->
	<delete id="deleteBoard">

			DELETE FROM TB_BOARD
			WHERE IDX=#{idx}

	</delete>

<!-- 게시글 보기 -->
	<select id="selectBoard" resultType="boardVo">

			SELECT *
			FROM TB_BOARD
			WHERE IDX=#{idX}

	</select>

<!-- 게시글 갯수 -->
	<select id="selectBoardListTotCnt"  parameterType="boardVO" resultType="int">

			SELECT COUNT(*) totcnt
			FROM TB_BOARD A 
			WHERE 1=1
			
	</select>
	
<!-- 조회수 -->	
	<update id="BoardCount" >

			UPDATE  TB_BOARD
			SET		COUNT = COUNT + 1
			WHERE IDX=#{idx}
			
	</update>
	
<!-- 로그인 체크 -->	
	<select id="selectLoginCheck" parameterType="boardVo" resultType="String">

			SELECT USER_NAME
			FROM TB_USER
			WHERE 1=1
			AND USER_ID = #{userId}
			AND PASSWORD = #{password}
	
	</select>

</mapper>